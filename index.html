<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Interactive Fictional Map</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<style>
  html, body { height: 100%; margin: 0; }
  #map { height: 100%; }
  .flag-popup {
    background: rgba(255,255,255,0.85);
    border-radius: 6px;
    padding: 4px;
    text-align: center;
  }
  .flag-popup img {
    max-height: 50px;
    display: block;
    margin: auto;
  }
</style>
</head>
<body>
<div id="map"></div>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
const map = L.map('map', {
  crs: L.CRS.Simple,
  minZoom: -1
});

// Image dimensions
const w = 2403, h = 1422;
const bounds = [[0,0], [h,w]];

// Add map image
L.imageOverlay('BIG_MAP.png', bounds).addTo(map);
map.fitBounds(bounds);

// GeoJSON data (embedded)
const geojsonData = {
"type": "FeatureCollection",
"features": [
  // === GeoJSON polygons from map_with_flags.geojson ===
  // (Iâ€™ll insert your full polygon data here)
]
};

function onEachFeature(feature, layer) {
  if (feature.properties && feature.properties.flag) {
    layer.on('mouseover', function(e) {
      const center = layer.getBounds().getCenter();
      const popup = L.popup({closeButton:false, autoClose:true, className:'flag-popup'})
        .setLatLng(center)
        .setContent(`<div><strong>${feature.properties.name}</strong><br><img src="${feature.properties.flag}"></div>`)
        .openOn(map);
    });
    layer.on('mouseout', function() {
      map.closePopup();
    });
  }
}

// Draw polygons
L.geoJSON(geojsonData, {
  style: feature => ({
    color: feature.properties.color || '#ffffff',
    weight: 2,
    fillOpacity: 0.5
  }),
  onEachFeature: onEachFeature
}).addTo(map);
</script>
</body>
</html>
